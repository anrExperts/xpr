<form xmlns:xf="http://www.w3.org/2002/xforms" xmlns:ev="http://www.w3.org/2001/xml-events">
    <xf:switch>
        <xf:case id="civilStatusPanel" selected="true">
            <xf:label>État civil</xf:label>
            <xf:group>
                <xf:label>Patronyme</xf:label>
                <xf:repeat id="repeatPersName" bind="persName">    
                    <xf:input ref="xpr:forename"><xf:label>Prénom</xf:label></xf:input>
                    <xf:input ref="xpr:namelink"><xf:label>Particule</xf:label></xf:input>
                    <xf:input ref="xpr:surname"><xf:label>Nom de famille</xf:label></xf:input>
                    <xf:select1 ref="@type" appearance="full">
                        <xf:label>Forme du nom</xf:label>
                        <xf:item>
                            <xf:label>Principale</xf:label>
                            <xf:value>full</xf:value>
                        </xf:item>
                        <xf:item>
                            <xf:label>Alternative</xf:label>
                            <xf:value>alternative</xf:value>
                        </xf:item>
                    </xf:select1>
                    
                    <xf:trigger class="delete">
                        <xf:label>&#10007;</xf:label>
                        <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//xpr:persName) > 1"/>
                        <xf:help>Supprimer une forme du nom.</xf:help>
                    </xf:trigger>
                </xf:repeat>
                <xf:trigger class="insert">
                    <xf:label>Ajouter une forme du nom</xf:label>
                    <xf:action ev:event="DOMActivate">
                        <xf:insert nodeset="xpr:persName" at="index('repeatPersName')" position="after" ev:event="DOMActivate"/>
                        <xf:setvalue ref="xpr:persName[index('repeatPersName')]//*" value=""/>
                    </xf:action>
                    <xf:help>Ajouter une forme du nom.</xf:help>
                </xf:trigger>
            </xf:group>
            
            <xf:group ref="instance('xprProsopo')/xpr:birth">
                <xf:label>Naissance</xf:label>
                <xf:input bind="birthDate" incremental="true"><xf:label>Date</xf:label></xf:input>
                <xf:input bind="birthPlace" incremental="true"><xf:label>Lieu</xf:label></xf:input>
                <!--@todo <xf:input><xf:label>Source</xf:label></xf:input>-->
            </xf:group>
            
            <xf:group ref="instance('xprProsopo')/xpr:death">
                <xf:label>Décès</xf:label>
                <xf:input bind="deathDate" incremental="true"><xf:label>Date</xf:label></xf:input>
                <xf:input bind="deathPlace" incremental="true"><xf:label>Lieu</xf:label></xf:input>
                <!--@ todo <xf:input><xf:label>Source</xf:label></xf:input>-->
            </xf:group>
            
        </xf:case>
        <xf:case id="eventsPanel" selected="false">
            <xf:label>Évènements</xf:label>
            <xf:group ref="xpr:events">
                <xf:repeat bind="event" id="repeatEvent">
                    <xf:select1 ref="@type">
                        <xf:label>Type d'évènements</xf:label>
                        <xf:item>
                            <xf:label></xf:label>
                            <xf:value></xf:value>
                            <xf:action ev:event="xforms-select">
                                <xf:setvalue ref="parent::xpr:event/xpr:label"></xf:setvalue>
                            </xf:action>
                        </xf:item>
                    </xf:select1>
                    <xf:input ref="xpr:desc"><xf:label>Description</xf:label></xf:input>
                    <xf:input ref="xpr:date"><xf:label>Date</xf:label></xf:input>
                    <xf:input ref="xpr:placeName"><xf:label>Lieu</xf:label></xf:input>
                    
                    <xf:input ref="xpr:ref"><xf:label>Référence</xf:label></xf:input>
                    <xf:input ref="xpr:bibl"><xf:label>source</xf:label></xf:input>
                    <xf:trigger class="delete">
                        <xf:label>&#10007;</xf:label>
                        <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//xpr:event) > 1"/>
                        <xf:help>Supprimer un évènement.</xf:help>
                    </xf:trigger>
                </xf:repeat>
                <xf:trigger class="insert">
                    <xf:label>Ajouter un évènement</xf:label>
                    <xf:action ev:event="DOMActivate">
                        <xf:insert nodeset="xpr:event" at="index('repeatEvent')" position="after" ev:event="DOMActivate"/>
                        <xf:setvalue ref="xpr:event[index('repeatEvent')]//*" value=""/>
                    </xf:action>
                    <xf:help>Ajouter un évènement.</xf:help>
                </xf:trigger>
            </xf:group>
        </xf:case>
        <xf:case id="relationsPanel" selected="false">
            <xf:label>Relations<!--@rmq Réseaux ?--></xf:label>
        </xf:case>
    </xf:switch>
    <xf:submit submission="submit">
        <xf:label>Enregistrer</xf:label>
    </xf:submit>
</form>

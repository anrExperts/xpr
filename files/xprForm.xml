<html lang="fr" xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xf="http://www.w3.org/2002/xforms" xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <head>
        <title>xpr (formulaire)</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="description" content="Formulaire de dépouillement Z1J" />
        <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono:400,400i|IBM+Plex+Sans+Condensed:400,400i|IBM+Plex+Sans:100,100i,400,400i,700,700i|IBM+Plex+Serif:400,400i" rel="stylesheet" />
        <link href="files/css/normalize.css" rel="stylesheet" />
        <link href="/xpr/files/css/main.css" rel="stylesheet" />
        <!-- XForms data models -->
        <xf:model>
            <xf:instance id="xprModel" src="/xpr/files/xprInstance.xml"/>
            
            <xf:instance id="xprExperts" src="/xpr/files/xprExperts.xml"/>
            <xf:instance id="xprAppendice" src="/xpr/files/xprAppendice.xml"/>
            <xf:instance id="xprCategories" src="/xpr/files/xprCategories.xml"/>
            <xf:instance id="xprObjects" src="/xpr/files/xprObjects.xml"/>
            <xf:instance id="xprExpenses" src="/xpr/files/xprExpenses.xml"/>
            <xf:instance id="xprFees" src="/xpr/files/xprFees.xml"/>

            <xf:submission id="submit" resource="put" method="PUT" />

            <!--**sourceDesc**-->
            <xf:bind id="sourceDesc" nodeset="sourceDesc"/>
            <!--référence-->

            <xf:bind id="unitid" nodeset="sourceDesc/idno[@type='unitid']" required="true()"/>

            <xf:bind id="item" nodeset="sourceDesc/idno[@type='item']" required="true()"/>

            <xf:bind id="facsimileFrom" nodeset="sourceDesc/facsimile/@from"/>

            <xf:bind id="facsimileTo" nodeset="sourceDesc/facsimile/@to"/>

            <!--physDesc-->
            <xf:bind id="physDesc" nodeset="physDesc"/>

            <xf:bind id="extent" nodeset="sourceDesc/physDesc/extent"/>

            <xf:bind id="sketch" nodeset="sourceDesc/physDesc/extent/@sketch"/>

            <xf:bind id="appendice" nodeset="sourceDesc/physDesc/appendices/appendice"/>

            <xf:bind id="appendiceType" nodeset="sourceDesc/physDesc/appendices/appendice/type"/>

            <xf:bind id="appendiceExtent" nodeset="sourceDesc/physDesc/appendices/appendice/extent"/>

            <xf:bind id="appendiceDesc" nodeset="sourceDesc/physDesc/appendices/appendice/desc"/>

            <xf:bind id="appendiceNote" nodeset="sourceDesc/physDesc/appendices/appendice/note"/>

            <!--<xf:bind
                    nodeset="sourceDesc/physDesc/appendices/appendice/@subtype"
                    relevant="./parent::appendice[contains(@type, 'other')]"/>-->
            <!--**description**-->
            <xf:bind id="description" nodeset="description"/>

            <!--sessions-->
            <xf:bind id="sessions" nodeset="description/sessions"/>

            <xf:bind id="sessionsDate" nodeset="description/sessions/date"/>

            <xf:bind id="sessionsWhen" nodeset="description/sessions/session/@when"/>

            <xf:bind id="sessionsType" nodeset="description/sessions/date/@type"/>

            <!--places-->
            <xf:bind id="places" nodeset="description/places"/>

            <xf:bind id="place" nodeset="description/places/place"/>

            <xf:bind id="placeAddress" nodeset="description/places/place/address" relevant="../@type='paris' 
                    or ../@type='suburbs' 
                    or ../@type='province' 
                    or ../@type='indeterminate'"/>

            <xf:bind id="placeComplement" nodeset="description/places/place/complement" relevant="../@type='paris' 
                    or ../@type='suburbs' 
                    or ../@type='province' 
                    or ../@type='indeterminate'"/>

            <xf:bind id="placeParish" nodeset="description/places/place/parish" relevant="../@type='paris'"/>

            <xf:bind id="placeCity" nodeset="description/places/place/city" relevant="../@type='suburbs' 
                    or ../@type='province'"/>

            <xf:bind id="placeDistrict" nodeset="description/places/place/district" relevant="../@type='suburbs' 
                    or ../@type='province'"/>

            <xf:bind id="placeOwner" nodeset="description/places/place/owner" relevant="../@type='paris' 
                    or ../@type='suburbs' 
                    or ../@type='province' 
                    or ../@type='indeterminate'"/>

            <!--Categories-->

            <xf:bind id="categories" nodeset="description/categories"/>

            <xf:bind id="category" nodeset="description/categories/category"/>

            <xf:bind id="categoryType" nodeset="description/categories/category/@type"/>

            <xf:bind id="designation" nodeset="description/categories/designation"/>

            <xf:bind id="designationRubric" nodeset="description/categories/designation/@rubric"/>

            <!--procedure encadrant l'expertise-->
            <xf:bind id="procedure" nodeset="description/procedure"/>
            <!--cadre-->
            <xf:bind id="framework" nodeset="description/procedure/framework"/>

            <xf:bind id="frameworkType" nodeset="description/procedure/framework/@type"/>

            <!--Origine de l'expertise-->
            <xf:bind id="origination" nodeset="description/procedure/origination"/>

            <xf:bind id="originationType" nodeset="description/procedure/origination/@type"/>

            <!--intervention d'une institution-->
            <xf:bind id="sentences" nodeset="description/procedure/sentences"/>

            <xf:bind id="sentence" nodeset="description/procedure/sentences/sentence"/>

            <xf:bind id="sentenceOrg" nodeset="description/procedure/sentences/sentence/orgName"/>

            <xf:bind id="sentenceDate" nodeset="description/procedure/sentences/sentence/date"/>

            <!--Cause de l'expertise-->
            <xf:bind id="case" nodeset="description/procedure/case"/>

            <!--Objets de l'expertise-->
            <xf:bind id="objectOther" nodeset="description/procedure/objects/object[@type='other']" relevant="."/>

            <!--Acteurs de l'expertise-->
            <xf:bind id="participants" nodeset="description/participants"/>

            <!--Les experts-->
            <xf:bind id="experts" nodeset="description/participants/experts"/>

            <xf:bind id="expert" nodeset="description/participants/experts/expert"/>
            
            <xf:bind id="expertRef" nodeset="description/participants/experts/expert/@ref"/>

            <xf:bind id="expertTitle" nodeset="description/participants/experts/expert/title"/>

            <!--Les greffiers-->
            <xf:bind id="clerks" nodeset="description/participants/clerks"/>

            <xf:bind id="clerk" nodeset="description/participants/clerks/clerk"/>

            <xf:bind id="clerkName" nodeset="description/participants/clerks/clerk/persName"/>

            <xf:bind id="clerkSurname" nodeset="description/participants/clerks/clerk/persName/surname"/>

            <xf:bind id="clerkForename" nodeset="description/participants/clerks/clerk/persName/forename"/>

            <!--Les parties-->
            <xf:bind id="parties" nodeset="description/participants/parties"/>

            <xf:bind id="party" nodeset="description/participants/parties/party"/>

            <xf:bind id="person" nodeset="description/participants/parties/party/person"/>

            <xf:bind id="personName" nodeset="description/participants/parties/party/person/persName"/>

            <xf:bind id="personSurname" nodeset="description/participants/parties/party/person/persName/surname"/>

            <xf:bind id="personForename" nodeset="description/participants/parties/party/person/persName/forename"/>

            <xf:bind id="personOccupation" nodeset="description/participants/parties/party/person/occupation"/>

            <xf:bind id="partyExpert" nodeset="description/participants/parties/party/expert"/>

            <xf:bind id="representative" nodeset="description/participants/parties/party/representative"/>

            <xf:bind id="representativeName" nodeset="description/participants/parties/party/representative/persName"/>

            <xf:bind id="representativeSurname" nodeset="description/participants/parties/party/representative/persName/surname"/>

            <xf:bind id="representativeForename" nodeset="description/participants/parties/party/representative/persName/forename"/>

            <xf:bind id="representativeOccupation" nodeset="description/participants/parties/party/representative/occupation"/>

            <xf:bind id="prosecutor" nodeset="description/participants/parties/party/prosecutor"/>

            <xf:bind id="prosecutorName" nodeset="description/participants/parties/party/prosecutor/persName"/>

            <xf:bind id="prosecutorSurname" nodeset="description/participants/parties/party/prosecutor/persName/surname"/>

            <xf:bind id="prosecutorForename" nodeset="description/participants/parties/party/prosecutor/persName/forename"/>

            <!--Entrepreneur, architecte ou maître d’œuvre-->

            <xf:bind id="craftmen" nodeset="description/participants/craftmen"/>

            <xf:bind id="craftman" nodeset="description/participants/craftmen/craftman"/>

            <xf:bind id="craftmanName" nodeset="description/participants/craftmen/craftman/persName"/>

            <xf:bind id="craftmanSurname" nodeset="description/participants/craftmen/craftman/persName/surname"/>

            <xf:bind id="craftmanForename" nodeset="description/participants/craftmen/craftman/persName/Forename"/>

            <xf:bind id="craftmanOccupation" nodeset="description/participants/craftmen/craftman/occupation"/>

            <!--Conclusions-->
            <xf:bind id="conclusions" nodeset="description/conclusions"/>

            <xf:bind id="agreement" nodeset="description/conclusions/agreement"/>

            <xf:bind id="agreementType" nodeset="description/conclusions/agreement/@type"/>

            <xf:bind id="opinion" nodeset="description/conclusions/opinion"/>

            <xf:bind id="estimate" nodeset="description/conclusions/estimate"/>

            <xf:bind id="fees" nodeset="description/conclusions/fees"/>

            <xf:bind id="feesDetail" nodeset="description/conclusions/fees/@detail"/>

            <xf:bind id="fee" nodeset="instance('xprFees')/fee" relevant="instance('xprModel')/description/conclusions/fees[@detail='true']"/>

            <xf:bind id="feesTotal" nodeset="description/conclusions/fees/total"/>

            <xf:bind id="expenses" nodeset="description/conclusions/expenses"/>

            <xf:bind id="expensesMentioned" nodeset="description/conclusions/expenses/@mentioned"/>

            <xf:bind id="expenseType" nodeset="instance('xprExpenses')/expense" relevant="instance('xprModel')/description/conclusions/expenses[@mentioned='true']"/>

        </xf:model>
    </head>
    <body>
        <h1>Formulaire Z1J</h1>
        <form>
            <xf:trigger>
                <xf:label>Références</xf:label>
                <xf:toggle case="referencesPanel" ev:event="DOMActivate"/>
            </xf:trigger>
            <xf:trigger>
                <xf:label>Vacations</xf:label>
                <xf:toggle case="sessionsPanel" ev:event="DOMActivate"/>
            </xf:trigger>
            <xf:trigger>
                <xf:label>Descriptions</xf:label>
                <xf:toggle case="physDescPanel" ev:event="DOMActivate"/>
            </xf:trigger>
            <xf:trigger>
                <xf:label>Lieux de l’expertise</xf:label>
                <xf:toggle case="placesPanel" ev:event="DOMActivate"/>
            </xf:trigger>
            <xf:trigger>
                <xf:label>Catégories de l’expertise</xf:label>
                <xf:toggle case="categoriesPanel" ev:event="DOMActivate"/>
            </xf:trigger>
            <xf:trigger>
                <xf:label>Procédure et cadre de l’expertise</xf:label>
                <xf:toggle case="procedurePanel" ev:event="DOMActivate"/>
            </xf:trigger>
            <xf:trigger>
                <xf:label>Acteurs de l’expertise</xf:label>
                <xf:toggle case="participantsPanel" ev:event="DOMActivate"/>
            </xf:trigger>
            <xf:trigger>
                <xf:label>Conclusions ou dispositifs de l’expertise</xf:label>
                <xf:toggle case="conclusionsPanel" ev:event="DOMActivate"/>
            </xf:trigger>
            <xf:switch>
                <xf:case id="referencesPanel" selected="true">
                    <xf:label>Références</xf:label>
                    <xf:group ref="sourceDesc/idno">
                        <xf:label>Identifiants</xf:label>
                        <xf:input bind="unitid" incremental="true">
                            <xf:label>Cote</xf:label>
                        </xf:input>
                        <xf:input bind="item" incremental="true">
                            <xf:label>Dossier</xf:label>
                        </xf:input>
                    </xf:group>
                    <xf:group ref="sourceDesc/facsimile">
                        <xf:label>Identifiants des vues</xf:label>
                        <xf:input bind="facsimileFrom" incremental="true">
                            <xf:label>Première vue</xf:label>
                        </xf:input>
                        <xf:input bind="facsimileTo" incremental="true">
                            <xf:label>Dernière vue</xf:label>
                        </xf:input>
                    </xf:group>
                    <!--control-->
                    <pre>
                            <xf:output value="serialize(sourceDesc, 'yes')"/>
                        </pre>
                </xf:case>
                <xf:case id="sessionsPanel" selected="false">
                    <xf:label>Vacations</xf:label>
                    <xf:group ref="description/sessions">
                        <xf:repeat id="repeatSession" bind="sessionsDate">
                            <xf:input ref="@when" incremental="true">
                                <xf:label>Date</xf:label>
                            </xf:input>
                            <xf:select1 ref="@type">
                                <xf:label>Lieu</xf:label>
                                <xf:item>
                                    <xf:label>Paris et faubourgs</xf:label>
                                    <xf:value>paris</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Banlieue</xf:label>
                                    <xf:value>suburbs</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Campagne</xf:label>
                                    <xf:value>province</xf:value>
                                </xf:item>
                            </xf:select1>
                            <xf:trigger>
                                <xf:label>&#10007;</xf:label>
                                <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//description/sessions/date) > 1"/>
                            </xf:trigger>
                        </xf:repeat>
                        <xf:trigger>
                            <xf:label>Ajouter une vacation</xf:label>
                            <xf:action ev:event="DOMActivate">
                                <xf:insert nodeset="date" at="index('repeatSession')" position="after" ev:event="DOMActivate"/>
                                <xf:setvalue ref="date[index('repeatSession')]/@when" value=""/>
                                <xf:setvalue ref="date[index('repeatSession')]/@type" value=""/>
                            </xf:action>
                        </xf:trigger>
                    </xf:group>
                    <pre>
                            <xf:output value="serialize(description/sessions, 'yes')"/>
                        </pre>
                </xf:case>
                <xf:case id="physDescPanel" selected="false">
                    <xf:label>Description physique du procès-verbal et des pièces annexes</xf:label>
                    <xf:group>
                        <xf:input bind="extent" incremental="true">
                            <xf:label>Nombre de cahiers et de feuillets</xf:label>
                        </xf:input>
                        <xf:select1 bind="sketch">
                            <xf:label>Croquis sur le procès-verbal</xf:label>
                            <xf:item>
                                <xf:label>oui</xf:label>
                                <xf:value>true</xf:value>
                            </xf:item>
                            <xf:item>
                                <xf:label>non</xf:label>
                                <xf:value>false</xf:value>
                            </xf:item>
                        </xf:select1>
                    </xf:group>
                    <xf:group ref="sourceDesc/physDesc/appendices">
                        <xf:label>Pièces annexes</xf:label>
                        <!--@rmq Pourra servir au contrôle à partir des informations tirées du récolement. -->
                        <xf:output value="count(//sourceDesc/physDesc/appendices/appendice)"><xf:label>Nombre de pièces annexes</xf:label></xf:output>
                        <xf:repeat id="repeatAppendice" bind="appendice" appearance="full">
                            <xf:repeat id="repeatAppendiceType" nodeset="type">
                                <xf:select1 ref="@type">
                                    <!--@bug il existe l'attribut selection="open" pour ces cas mais il ne semble pas fonctionner. Il permet de préciser une valeur qui ne serait pas dans la liste.-->
                                    <!-- https://sourceforge.net/p/xsltforms/mailman/message/24465876/ -->
                                    <xf:label>Type de pièce annexe</xf:label>
                                    <xf:item>
                                        <xf:label>Dessin</xf:label>
                                        <xf:value>drawing</xf:value>
                                        <xf:action ev:event="xforms-select">
                                            <xf:setvalue ref="parent::type">Dessin</xf:setvalue>
                                        </xf:action>
                                    </xf:item>
                                    <xf:item>
                                        <xf:label>Plan</xf:label>
                                        <xf:value>plan</xf:value>
                                        <xf:action ev:event="xforms-select">
                                            <xf:setvalue ref="parent::type">Plan</xf:setvalue>
                                        </xf:action>
                                    </xf:item>
                                    <xf:item>
                                        <xf:label>Croquis</xf:label>
                                        <xf:value>sketch</xf:value>
                                        <xf:action ev:event="xforms-select">
                                            <xf:setvalue ref="parent::type">Croquis</xf:setvalue>
                                        </xf:action>
                                    </xf:item>
                                    <xf:item>
                                        <xf:label>Brouillon</xf:label>
                                        <xf:value>rough</xf:value>
                                        <xf:action ev:event="xforms-select">
                                            <xf:setvalue ref="parent::type">Brouillon</xf:setvalue>
                                        </xf:action>
                                    </xf:item>
                                    <xf:item>
                                        <xf:label>Pouvoir/procuration (acte sous seing privé)</xf:label>
                                        <xf:value>proxyPA</xf:value>
                                        <xf:action ev:event="xforms-select">
                                            <xf:setvalue ref="parent::type">Pouvoir/procuration (acte sous seing privé)</xf:setvalue>
                                        </xf:action>
                                    </xf:item>
                                    <xf:item>
                                        <xf:label>Pouvoir/procuration (acte notarié)</xf:label>
                                        <xf:value>proxyNA</xf:value>
                                        <xf:action ev:event="xforms-select">
                                            <xf:setvalue ref="parent::type">Pouvoir/procuration (acte notarié)</xf:setvalue>
                                        </xf:action>
                                    </xf:item>
                                    <xf:item>
                                        <xf:label>Requête</xf:label>
                                        <xf:value>petition</xf:value>
                                        <xf:action ev:event="xforms-select">
                                            <xf:setvalue ref="parent::type">Requête</xf:setvalue>
                                        </xf:action>
                                    </xf:item>
                                    <xf:item>
                                        <xf:label>Autre</xf:label>
                                        <xf:value>other</xf:value>
                                        <xf:action ev:event="xforms-select">
                                            <xf:setvalue ref="parent::type">À préciser</xf:setvalue>
                                        </xf:action>
                                    </xf:item>
                                </xf:select1>
                                <xf:input ref=".[@type='other']"> </xf:input>
                                <xf:trigger>
                                    <xf:label>X</xf:label>
                                    <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//sourceDesc/physDesc/appendices/appendice/type) > 1"/>
                                </xf:trigger>
                            </xf:repeat>
                            <xf:trigger>
                                <xf:label>Ajouter un type</xf:label>
                                <xf:action ev:event="DOMActivate">
                                    <xf:insert nodeset="type" at="index('repeatAppendiceType')" position="after"/>
                                    <xf:setvalue ref="type[index('repeatAppendiceType')]" value=""/>
                                    <xf:setvalue ref="type[index('repeatAppendiceType')]/@type" value=""/>
                                </xf:action>
                            </xf:trigger>
                            <!--@todo appendice autre-->
                            <xf:input ref="extent" incremental="true">
                                <xf:label>Nombre de feuillets</xf:label>
                            </xf:input>
                            <xf:textarea ref="desc" incremental="true">
                                <xf:label>Description physique</xf:label>
                            </xf:textarea>
                            <xf:textarea ref="note" incremental="true">
                                <xf:label>Commentaires</xf:label>
                            </xf:textarea>
                            <xf:trigger>
                                <xf:label>Supprimer une annexe</xf:label>
                                <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//sourceDesc/physDesc/appendices/appendice) > 1"/>
                            </xf:trigger>
                        </xf:repeat>
                        <xf:trigger>
                            <xf:label>Ajouter une pièce annexe</xf:label>
                            <xf:action ev:event="DOMActivate">
                                <xf:insert nodeset="appendice" at="index('repeatAppendice')" position="after" ev:event="DOMActivate"/>
                                <xf:delete ref="appendice[index('repeatAppendice')]/type[position() &gt; 1]"/>
                                <xf:setvalue ref="appendice[index('repeatAppendice')]/type" value=""/>
                                <xf:setvalue ref="appendice[index('repeatAppendice')]/type/@type" value=""/>
                                <xf:setvalue ref="appendice[index('repeatAppendice')]/extent" value=""/>
                                <xf:setvalue ref="appendice[index('repeatAppendice')]/desc" value=""/>
                                <xf:setvalue ref="appendice[index('repeatAppendice')]/note" value=""/>
                            </xf:action>
                        </xf:trigger>
                    </xf:group>
                    <!--control-->
                    <pre>
                            <xf:output value="serialize(sourceDesc/physDesc, 'yes')"/>
                        </pre>
                </xf:case>
                <xf:case id="placesPanel" selected="false">
                    <xf:label>Lieux de l’expertise</xf:label>
                    <xf:group ref="description/places">
                        <xf:repeat id="repeatPlace" bind="place" appearance="full">
                            <xf:select1 ref="@type">
                                <xf:item>
                                    <xf:label>Paris</xf:label>
                                    <xf:value>paris</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Banlieue</xf:label>
                                    <xf:value>suburbs</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Campagne</xf:label>
                                    <xf:value>province</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Bureau des experts</xf:label>
                                    <xf:value>office</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Indéterminé</xf:label>
                                    <xf:value>indeterminate</xf:value>
                                </xf:item>
                            </xf:select1>
                            <xf:input ref="address">
                                <xf:label>Voie</xf:label>
                            </xf:input>
                            <xf:input ref="complement">
                                <xf:label>Précisions géographiques</xf:label>
                            </xf:input>
                            <xf:input ref="parish">
                                <xf:label>Paroisse</xf:label>
                            </xf:input>
                            <xf:input ref="city">
                                <xf:label>Ville</xf:label>
                            </xf:input>
                            <xf:input ref="district">
                                <xf:label>Département</xf:label>
                            </xf:input>
                            <xf:repeat id="repeatOwner" nodeset="owner" appearance="full">
                                <xf:input ref=".">
                                    <xf:label>Propriétaire</xf:label>
                                </xf:input>
                                <xf:trigger>
                                    <xf:label>Supprimer un propriétaire</xf:label>
                                    <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//description/places/place[index('repeatPlace')]/owner) > 1"/>
                                </xf:trigger>
                            </xf:repeat>
                            <xf:trigger>
                                <xf:label>Ajouter un propriétaire</xf:label>
                                <xf:action ev:event="DOMActivate">
                                    <xf:insert nodeset="owner" at="index('repeatOwner')" position="after" ev:event="DOMActivate"/>
                                    <xf:setvalue ref="place/owner[index('repeatOwner')]" value=""/>
                                </xf:action>
                            </xf:trigger>
                            <xf:trigger>
                                <xf:label>Supprimer un lieu</xf:label>
                                <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//description/places/place) > 1"/>
                            </xf:trigger>
                        </xf:repeat>
                        <xf:trigger>
                            <xf:label>Ajouter un lieu</xf:label>
                            <xf:action ev:event="DOMActivate">
                                <xf:insert nodeset="place" at="index('repeatPlace')" position="after" ev:event="DOMActivate"/>
                                <xf:setvalue ref="place[index('repeatPlace')]/@type" value=""/>
                                <xf:setvalue ref="place[index('repeatPlace')]/address" value=""/>
                                <xf:setvalue ref="place[index('repeatPlace')]/complement" value=""/>
                                <xf:setvalue ref="place[index('repeatPlace')]/parish" value=""/>
                                <xf:setvalue ref="place[index('repeatPlace')]/city" value=""/>
                                <xf:setvalue ref="place[index('repeatPlace')]/province" value=""/>
                                <xf:setvalue ref="place[index('repeatPlace')]/owner" value=""/>
                            </xf:action>
                        </xf:trigger>
                    </xf:group>
                    <!--control-->
                    <pre>
                            <xf:output value="serialize(description/places, 'yes')"/>
                        </pre>
                </xf:case>
                <xf:case id="categoriesPanel" selected="false">
                    <xf:label>Types d’expertise</xf:label>
                    <xf:group ref="instance('xprCategories')">
                        <xf:select ref="category" appearance="full">
                            <xf:label>Catégories d’expertise</xf:label>
                            <xf:item>
                                <xf:label>Estimer la valeur des biens</xf:label>
                                <xf:value>estimation</xf:value>
                                <xf:action ev:event="xforms-select">
                                    <xf:insert context="instance('xprModel')/description/categories" origin="instance('xprCategories')/category[@type='estimation']"/>
                                </xf:action>
                                <xf:action ev:event="xforms-deselect">
                                    <xf:delete ref="instance('xprModel')/description/categories/category[@type='estimation']"/>
                                </xf:action>
                            </xf:item>
                            <xf:item>
                                <xf:label>Recevoir et évaluer le travail réalisé</xf:label>
                                <xf:value>acceptation</xf:value>
                                <xf:action ev:event="xforms-select">
                                    <xf:insert context="instance('xprModel')/description/categories" origin="instance('xprCategories')/category[@type='acceptation']"/>
                                </xf:action>
                                <xf:action ev:event="xforms-deselect">
                                    <xf:delete ref="instance('xprModel')/description/categories/category[@type='acceptation']"/>
                                </xf:action>
                            </xf:item>
                            <xf:item>
                                <xf:label>Enregistrer</xf:label>
                                <xf:value>registration</xf:value>
                                <xf:action ev:event="xforms-select">
                                    <xf:insert context="instance('xprModel')/description/categories" origin="instance('xprCategories')/category[@type='registration']"/>
                                </xf:action>
                                <xf:action ev:event="xforms-deselect">
                                    <xf:delete ref="instance('xprModel')/description/categories/category[@type='registration']"/>
                                </xf:action>
                            </xf:item>
                            <xf:item>
                                <xf:label>Départager</xf:label>
                                <xf:value>settlement</xf:value>
                                <xf:action ev:event="xforms-select">
                                    <xf:insert context="instance('xprModel')/description/categories" origin="instance('xprCategories')/category[@type='settlement']"/>
                                </xf:action>
                                <xf:action ev:event="xforms-deselect">
                                    <xf:delete ref="instance('xprModel')/description/categories/category[@type='settlement']"/>
                                </xf:action>
                            </xf:item>
                            <xf:item>
                                <xf:label>Évaluer les coûts à venir</xf:label>
                                <xf:value>assessment</xf:value>
                                <xf:action ev:event="xforms-select">
                                    <xf:insert context="instance('xprModel')/description/categories" origin="instance('xprCategories')/category[@type='assessment']"/>
                                </xf:action>
                                <xf:action ev:event="xforms-deselect">
                                    <xf:delete ref="instance('xprModel')/description/categories/category[@type='assessment']"/>
                                </xf:action>
                            </xf:item>
                        </xf:select>
                        <xf:input bind="designation" incremental="true">
                            <xf:label>Désignation</xf:label>
                        </xf:input>
                        <xf:select1 bind="designationRubric" appearance="full">
                            <xf:label>En rubrique</xf:label>
                            <xf:item>
                                <xf:label>oui</xf:label>
                                <xf:value>true</xf:value>
                            </xf:item>
                            <xf:item>
                                <xf:label>non</xf:label>
                                <xf:value>false</xf:value>
                            </xf:item>
                        </xf:select1>
                    </xf:group>
                    <!--control-->
                    <pre>
                            <xf:output value="serialize(description/categories, 'yes')"/>
                        </pre>
                </xf:case>
                <xf:case id="procedurePanel" selected="false">
                    <xf:label>Procédure et cadre de l’expertise</xf:label>
                    <xf:group ref="description/procedure">
                        <xf:group ref="framework">
                            <xf:select1 bind="frameworkType" appearance="full">
                                <!--@quest je ne suis pas certain qu'il y a besoin de détailler autant ? (juste besoin de A-B1-B2A-B2B-C)-->
                                <!--@todo ajouter un output pour le texte de framework-->
                                <!--@rmq voir si on peut passer par un petit modèle de raisonnement pour garder la logique B-B2-B2a-->
                                <!--@todo à défaut, mettre un message d'alerte si B ou B2 sont cochés-->
                                <xf:label>Procédure</xf:label>
                                <xf:item>
                                    <xf:label>A/ Commun accord des parties</xf:label>
                                    <xf:value>a</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:setvalue ref="parent::framework">Commun accord des parties</xf:setvalue>
                                    </xf:action>
                                </xf:item>
                                <xf:choices>
                                    <xf:label>B/ Saisie du lieutenant civil (ou autre, à préciser)</xf:label>
                                    <xf:item>
                                        <xf:label>B1/ Requête auprès du LC pour qu’il demande une expertise</xf:label>
                                        <xf:value>b1</xf:value>
                                        <xf:action ev:event="xforms-select">
                                            <xf:setvalue ref="parent::framework">Requête auprès du lieutenant civil pour qu’il demande une expertise</xf:setvalue>
                                        </xf:action>
                                    </xf:item>
                                </xf:choices>
                                <xf:choices>
                                    <xf:label>B2/ Le LC est saisi dans le cadre d’une procédure</xf:label>
                                    <xf:item>
                                        <xf:label>B2a/ LC saisi dans le cadre d’une procédure (Les parties nomment chacune leur expert ou un expert commun)</xf:label>
                                        <xf:value>b2a</xf:value>
                                        <xf:action ev:event="xforms-select">
                                            <xf:setvalue ref="parent::framework">Le lieutenant civil est saisi dans le cadre d’une procédure (les parties nomment chacune leur expert ou un expert en commun)</xf:setvalue>
                                        </xf:action>
                                    </xf:item>
                                    <xf:item>
                                        <xf:label>B2b/ LC saisi dans le cadre d’une procédure (Le LC nomme un ou deux experts)</xf:label>
                                        <xf:value>b2b</xf:value>
                                        <xf:action ev:event="xforms-select">
                                            <xf:setvalue ref="parent::framework">Le lieutenant civil est saisi dans le cadre d’une procédure (le lieutenant civil nomme un ou deux experts)</xf:setvalue>
                                        </xf:action>
                                    </xf:item>
                                </xf:choices>
                                <!--@todo comment faire pour préciser si ce n'est pas le LC ?-->
                                <xf:item>
                                    <xf:label>C/ Cas problématique</xf:label>
                                    <xf:value>c</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:setvalue ref="parent::framework">Cas problématique</xf:setvalue>
                                    </xf:action>
                                </xf:item>
                            </xf:select1>
                        </xf:group>
                        <xf:group ref="origination">
                            <xf:label>Origine de l’expertise</xf:label>
                            <xf:select1 bind="originationType">
                                <xf:label>Déclenchement de l’expertise</xf:label>
                                <xf:item>
                                    <xf:label>Les parties</xf:label>
                                    <xf:value>parties</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:setvalue ref="ancestor::origination" value="'Les parties'"/>
                                    </xf:action>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Une institution</xf:label>
                                    <xf:value>institution</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:setvalue ref="ancestor::origination" value="'Une institution'"/>
                                    </xf:action>
                                </xf:item>
                            </xf:select1>
                        </xf:group>
                        <xf:group ref="sentences">
                            <xf:label>Intervention d’une institution</xf:label>
                            <xf:repeat id="repeatSentence" bind="sentence" appearance="full">
                                <xf:input ref="orgName" incremental="true">
                                    <xf:label>Description de l’institution</xf:label>
                                </xf:input>
                                <xf:repeat id="repeatDateSentence" nodeset="date">
                                    <xf:input ref=".">
                                        <xf:label>Date</xf:label>
                                    </xf:input>
                                    <xf:trigger>
                                        <xf:label>Supprimer une date</xf:label>
                                        <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//description/procedure/sentences/sentence/date) > 1"/>
                                    </xf:trigger>
                                </xf:repeat>
                                <xf:trigger>
                                    <xf:label>Ajouter une date</xf:label>
                                    <xf:action ev:event="DOMActivate">
                                        <xf:insert nodeset="date" at="index('repeatDateSentence')" position="after" ev:event="DOMActivate"/>
                                        <xf:setvalue ref="date[index('repeatDateSentence')]" value=""/>
                                    </xf:action>
                                </xf:trigger>
                                <xf:trigger>
                                    <xf:label>Supprimer une institution</xf:label>
                                    <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//description/procedure/sentences/sentence) > 1"/>
                                </xf:trigger>
                            </xf:repeat>
                            <!--@todo si l'on a renseigné une première institution avec plusieurs sentences, lorsqu'on ajoute une institution, le même nombre de sentence est copié => le remettre à 1-->
                            <xf:trigger>
                                <xf:label>Ajouter une institution</xf:label>
                                <xf:action ev:event="DOMActivate">
                                    <xf:insert nodeset="sentence" at="index('repeatSentence')" position="after" ev:event="DOMActivate"/>
                                    <xf:setvalue ref="sentence[index('repeatSentence')]/orgName" value=""/>
                                    <xf:setvalue ref="sentence[index('repeatSentence')]/date" value=""/>
                                </xf:action>
                            </xf:trigger>
                        </xf:group>
                        <xf:group ref="case">
                            <xf:input bind="case" incremental="true">
                                <!--@todo mettre une zone de texte ?-->
                                <xf:label>Cause de l’expertise</xf:label>
                            </xf:input>
                        </xf:group>
                        <xf:group ref="instance('xprObjects')">
                            <xf:select ref="object" appearance="full">
                                <!--@bug il existe l'attribut selection="open" pour ces cas mais il ne semble pas fonctionner. Il permet de préciser une valeur qui ne serait pas dans la liste.-->
                                <!-- https://sourceforge.net/p/xsltforms/mailman/message/24465876/ -->
                                <xf:label>Objet de l’expertise</xf:label>
                                <xf:item>
                                    <xf:label>Maison</xf:label>
                                    <xf:value>house</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/procedure/objects" origin="instance('xprObjects')/object[@type='house']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/procedure/objects/object[@type='house']"/>
                                    </xf:action>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Terrain</xf:label>
                                    <xf:value>plot</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/procedure/objects" origin="instance('xprObjects')/object[@type='plot']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/procedure/objects/object[@type='plot']"/>
                                    </xf:action>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Ensemble de bâtiments</xf:label>
                                    <xf:value>buildings</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/procedure/objects" origin="instance('xprObjects')/object[@type='buildings']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/procedure/objects/object[@type='buildings']"/>
                                    </xf:action>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Domaine, terres, fief</xf:label>
                                    <xf:value>territory</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/procedure/objects" origin="instance('xprObjects')/object[@type='territory']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/procedure/objects/object[@type='territory']"/>
                                    </xf:action>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Mur</xf:label>
                                    <xf:value>wall</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/procedure/objects" origin="instance('xprObjects')/object[@type='wall']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/procedure/objects/object[@type='wall']"/>
                                    </xf:action>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Fosse d’aisance</xf:label>
                                    <xf:value>cesspool</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/procedure/objects" origin="instance('xprObjects')/object[@type='cesspool']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/procedure/objects/object[@type='cesspool']"/>
                                    </xf:action>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Puits</xf:label>
                                    <xf:value>well</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/procedure/objects" origin="instance('xprObjects')/object[@type='well']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/procedure/objects/object[@type='well']"/>
                                    </xf:action>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Autre</xf:label>
                                    <xf:value>other</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/procedure/objects" origin="instance('xprObjects')/object[@type='other']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/procedure/objects/object[@type='other']"/>
                                    </xf:action>
                                </xf:item>
                            </xf:select>
                            <xf:input ref="instance('xprModel')/description/procedure/objects/object[@type='other']"><xf:label>Autre, à préciser</xf:label></xf:input>
                        </xf:group>
                    </xf:group>
                    <!--control-->
                    <pre>
                            <xf:output value="serialize(description/procedure, 'yes')"/>
                        </pre>
                </xf:case>
                <xf:case id="participantsPanel" selected="false">
                    <xf:label>Acteurs de l’expertise</xf:label>
                    <xf:group ref="description/participants/experts">
                        <!--@todo au pluriel ?-->
                        <xf:label>Expert</xf:label>
                        <xf:repeat id="repeatExpert" nodeset="expert" appearance="full">
                            <xf:label>Patronyme</xf:label>
                            <xf:select1 ref="@ref" incremental="true">
                                <xf:itemset nodeset="instance('xprExperts')/expert">
                                    <xf:label value="concat(persName/surname,', ',persName/forename, ', ', provision)"/>
                                    <xf:value ref="@xml:id"/>
                                    <!--<xf:setvalue ref="instance('xprModel')/description/participants/experts/expert[index('repeatExpert')]/name" value="instance('xprExperts')/expert[@xml:id=./@xml:id]/name/surname" ev:event="xforms-selected"/>-->
                                    <!--<xf:action ev:event="xforms-value-changed">
                                        <xf:setvalue ref="instance('xprModel')/description/participants/experts/expert[index('repeatExpert')]/name" value="instance('xprExperts')/expert[@xml:id=instance('xprModel')/description/participants/experts/expert[index('repeatExpert')]/@ref]/name/surname"/>
                                    </xf:action>-->
                                </xf:itemset>
                            </xf:select1>
                            <xf:input ref="title" incremental="true">
                                <xf:label>Dénomination de l’expert dans l’acte</xf:label>
                            </xf:input>
                            <xf:select1 ref="@context">
                                <xf:label>Expert nommé en</xf:label>
                                <xf:item>
                                    <xf:label>premier lieu</xf:label>
                                    <xf:value>primary</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>tiers expert</xf:label>
                                    <xf:value>third-party</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>indéterminé</xf:label>
                                    <xf:value>unknown</xf:value>
                                </xf:item>
                            </xf:select1>
                            <xf:select1 ref="@appointment">
                                <xf:label>Expert nommé</xf:label>
                                <xf:item>
                                    <xf:label>d’office (par le lieutenant civil)</xf:label>
                                    <xf:value>court-appointed</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>par les parties</xf:label>
                                    <xf:value>appointed</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>indéterminé</xf:label>
                                    <xf:value>unknown</xf:value>
                                </xf:item>
                            </xf:select1>
                            <xf:trigger>
                                <xf:label>Supprimer un expert</xf:label>
                                <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//description/participants/experts/expert) > 1"/>
                            </xf:trigger>
                        </xf:repeat>
                        <xf:trigger>
                            <xf:label>Ajouter un expert</xf:label>
                            <xf:action ev:event="DOMActivate">
                                <xf:insert nodeset="expert" at="index('repeatExpert')" position="after" ev:event="DOMActivate"/>
                                <xf:setvalue ref="expert[index('repeatExpert')]/@ref" value=""/>
                                <xf:setvalue ref="expert[index('repeatExpert')]/@context" value=""/>
                                <xf:setvalue ref="expert[index('repeatExpert')]/@appointment" value=""/>
                                <xf:setvalue ref="expert[index('repeatExpert')]/title" value=""/>
                            </xf:action>
                        </xf:trigger>
                    </xf:group>
                    <!--control-->
                    <pre>
                            <xf:output value="serialize(description/participants/experts, 'yes')"/>
                        </pre>
                    <xf:group ref="description/participants/clerks">
                        <!--@todo au pluriel ?-->
                        <xf:label>Greffier</xf:label>
                        <xf:repeat id="repeatClerk" bind="clerk" appearance="full">
                            <xf:label>Patronyme</xf:label>
                            <xf:input ref="persName/surname" incremental="true">
                                <xf:label>Nom</xf:label>
                            </xf:input>
                            <xf:input ref="persName/forename" incremental="true">
                                <xf:label>Prénom</xf:label>
                            </xf:input>
                            <xf:trigger>
                                <xf:label>Supprimer un greffier</xf:label>
                                <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//description/participants/clerks/clerk) > 1"/>
                            </xf:trigger>
                        </xf:repeat>
                        <xf:trigger>
                            <xf:label>Ajouter un greffier</xf:label>
                            <xf:action ev:event="DOMActivate">
                                <xf:insert nodeset="clerk" at="index('repeatClerk')" position="after" ev:event="DOMActivate"/>
                                <xf:setvalue ref="clerk[index('repeatClerk')]/persName/surname" value=""/>
                                <xf:setvalue ref="clerk[index('repeatClerk')]/persName/forename" value=""/>
                            </xf:action>
                        </xf:trigger>
                    </xf:group>
                    <!--control-->
                    <pre>
                            <xf:output value="serialize(description/participants/clerks, 'yes')"/>
                        </pre>
                    <xf:group ref="description/participants/parties">
                        <xf:label>Parties</xf:label>
                        <xf:repeat id="repeatParty" bind="party" appearance="full">
                            <xf:repeat id="repeatPerson" nodeset="person" appearance="full">
                                <xf:label>Patronyme</xf:label>
                                <xf:input ref="persName/surname" incremental="true">
                                    <xf:label>Nom</xf:label>
                                </xf:input>
                                <xf:input ref="persName/forename" incremental="true">
                                    <xf:label>Prénom</xf:label>
                                </xf:input>
                                <xf:input ref="occupation">
                                    <xf:label>Qualité, profession</xf:label>
                                </xf:input>
                                <xf:trigger>
                                    <xf:label>Supprimer une personne</xf:label>
                                    <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//description/participants/parties/party/person) > 1"/>
                                </xf:trigger>
                            </xf:repeat>
                            <xf:trigger>
                                <xf:label>Ajouter une personne</xf:label>
                                <xf:action ev:event="DOMActivate">
                                    <xf:insert nodeset="person" at="index('repeatPerson')" position="after" ev:event="DOMActivate"/>
                                    <xf:setvalue ref="person[index('repeatPerson')]/persName/surname" value=""/>
                                    <xf:setvalue ref="person[index('repeatPerson')]/persName/forename" value=""/>
                                    <xf:setvalue ref="person[index('repeatPerson')]/occupation" value=""/>
                                </xf:action>
                            </xf:trigger>
                            <xf:select1 ref="@role">
                                <xf:label>Partie</xf:label>
                                <xf:item>
                                    <xf:label>Requérante</xf:label>
                                    <xf:value>petitioner</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Opposante</xf:label>
                                    <xf:value>opponent</xf:value>
                                </xf:item>
                            </xf:select1>
                            <xf:select1 ref="status">
                                <xf:label>Qualification individuelle</xf:label>
                                <xf:item>
                                    <xf:label>Entrepreneur</xf:label>
                                    <xf:value>builder</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Propriétaire</xf:label>
                                    <xf:value>owner</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Copropriétaire</xf:label>
                                    <xf:value>joint-owner</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Commanditaire</xf:label>
                                    <xf:value>limited-partner</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Héritier</xf:label>
                                    <xf:value>heir</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Voisin</xf:label>
                                    <xf:value>neighbour</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Locataire</xf:label>
                                    <xf:value>tenant</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Principal locataire</xf:label>
                                    <xf:value>main-tenant</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Créancier</xf:label>
                                    <xf:value>creditor</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Débiteur</xf:label>
                                    <xf:value>mortgagor</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Fermier judiciaire</xf:label>
                                    <xf:value>contractor</xf:value>
                                </xf:item>
                            </xf:select1>
                            <xf:select1 ref="expert/@ref">
                                <xf:label>Expert agissant pour cette partie</xf:label>
                                <xf:itemset nodeset="instance('xprExperts')/expert[@xml:id=instance('xprModel')/description/participants/experts/expert/@ref]">
                                    <xf:label value="concat(persName/surname,', ',persName/forename, ', ', provision)"/>
                                    <xf:value ref="@xml:id"/>
                                </xf:itemset>
                            </xf:select1>
                            <!--<xf:output ref="instance('xprExpert')/expert[@xml:id=instance('xprModel')/description/participants/experts/expert/@ref]/name/surname"/>-->
                            <!--@todo faire un repeat pour les représentants et procureurs ?-->
                            <xf:group ref="representative">
                                <xf:label>Représentants</xf:label>
                                <xf:repeat id="repeatRepresentative" nodeset="." appearance="full">
                                    <xf:label>Patronyme</xf:label>
                                    <xf:input ref="persName/surname" incremental="true">
                                        <xf:label>Nom</xf:label>
                                    </xf:input>
                                    <xf:input ref="persName/forename" incremental="true">
                                        <xf:label>Prénom</xf:label>
                                    </xf:input>
                                    <xf:input ref="occupation">
                                        <xf:label>Qualité, profession</xf:label>
                                    </xf:input>
                                    <xf:trigger>
                                        <xf:label>Supprimer un représentant</xf:label>
                                        <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//description/participants/parties/party/representative) > 1"/>
                                    </xf:trigger>
                                </xf:repeat>
                                <xf:trigger>
                                    <xf:label>Ajouter un représentant</xf:label>
                                    <xf:action ev:event="DOMActivate">
                                        <xf:insert nodeset="." at="index('repeatRepresentative')" position="after" ev:event="DOMActivate"/>
                                        <xf:setvalue ref="representative[index('repeatRepresentative')]/persName/surname" value=""/>
                                        <xf:setvalue ref="representative[index('repeatRepresentative')]/persName/forename" value=""/>
                                        <xf:setvalue ref="representative[index('repeatRepresentative')]/occupation" value=""/>
                                    </xf:action>
                                </xf:trigger>
                            </xf:group>
                            <xf:group ref="prosecutor">
                                <xf:label>Procureur</xf:label>
                                <xf:repeat id="repeatProsecutor" nodeset="." appearance="full">
                                    <xf:label>Patronyme</xf:label>
                                    <xf:input ref="persName/surname" incremental="true">
                                        <xf:label>Nom</xf:label>
                                    </xf:input>
                                    <xf:input ref="persName/forename" incremental="true">
                                        <xf:label>Prénom</xf:label>
                                    </xf:input>
                                    <xf:trigger>
                                        <xf:label>Supprimer un procureur</xf:label>
                                        <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//description/participants/parties/party/prosecutor) > 1"/>
                                    </xf:trigger>
                                </xf:repeat>
                                <xf:trigger>
                                    <xf:label>Ajouter un procureur</xf:label>
                                    <xf:action ev:event="DOMActivate">
                                        <xf:insert nodeset="." at="index('repeatProsecutor')" position="after" ev:event="DOMActivate"/>
                                        <xf:setvalue ref="prosecutor[index('repeatProsecutor')]/persName/surname" value=""/>
                                        <xf:setvalue ref="prosecutor[index('repeatProsecutor')]/persName/forename" value=""/>
                                    </xf:action>
                                </xf:trigger>
                            </xf:group>
                            <xf:select1 ref="@presence">
                                <xf:label>Partie présente</xf:label>
                                <xf:item>
                                    <xf:label>oui</xf:label>
                                    <xf:value>true</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>non</xf:label>
                                    <xf:value>false</xf:value>
                                </xf:item>
                            </xf:select1>
                            <xf:select1 ref="@intervention">
                                <xf:label>Partie intervenance</xf:label>
                                <xf:item>
                                    <xf:label>oui</xf:label>
                                    <xf:value>true</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>non</xf:label>
                                    <xf:value>false</xf:value>
                                </xf:item>
                            </xf:select1>
                            <xf:trigger>
                                <xf:label>Supprimer une partie</xf:label>
                                <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//description/participants/parties/party) > 1"/>
                            </xf:trigger>
                        </xf:repeat>
                        <xf:trigger>
                            <xf:label>Ajouter une partie</xf:label>
                            <xf:action ev:event="DOMActivate">
                                <xf:insert nodeset="party" at="index('repeatParty')" position="after" ev:event="DOMActivate"/>
                                <!--@todo set value-->
                                <xf:setvalue ref="party[index('repeatParty')]/@role" value=""/>
                                <xf:setvalue ref="party[index('repeatParty')]/@presence" value=""/>
                                <xf:setvalue ref="party[index('repeatParty')]/@intervention" value=""/>
                                <xf:delete ref="party[index('repeatParty')]/person[position() &gt; 1]"/>
                                <xf:setvalue ref="party[index('repeatParty')]/person/persName/surname" value=""/>
                                <xf:setvalue ref="party[index('repeatParty')]/person/persName/forename" value=""/>
                                <xf:setvalue ref="party[index('repeatParty')]/person/occupation" value=""/>
                                <xf:setvalue ref="party[index('repeatParty')]/status" value=""/>
                                <xf:setvalue ref="party[index('repeatParty')]/expert/@ref" value=""/>
                                <xf:delete ref="party[index('repeatParty')]/representative[position() &gt; 1]"/>
                                <xf:setvalue ref="party[index('repeatParty')]/representative/persName/surname" value=""/>
                                <xf:setvalue ref="party[index('repeatParty')]/representative/persName/forename" value=""/>
                                <xf:setvalue ref="party[index('repeatParty')]/representative/occupation" value=""/>
                                <xf:delete ref="party[index('repeatParty')]/prosecutor[position() &gt; 1]"/>
                                <xf:setvalue ref="party[index('repeatParty')]/prosecutor/persName/surname" value=""/>
                                <xf:setvalue ref="party[index('repeatParty')]/prosecutor/persName/forename" value=""/>
                            </xf:action>
                        </xf:trigger>
                    </xf:group>
                    <!--control-->
                    <pre>
                            <xf:output value="serialize(description/participants/parties, 'yes')"/>
                        </pre>
                    <xf:group ref="description/participants/craftmen">
                        <!--@quest au pluriel ?-->
                        <xf:label>Entrepreneur, architecte ou maître d’œuvre</xf:label>
                        <xf:repeat id="repeatCraftman" bind="craftman" appearance="full">
                            <xf:label>Patronyme</xf:label>
                            <xf:input ref="persName/surname" incremental="true">
                                <xf:label>Nom</xf:label>
                            </xf:input>
                            <xf:input ref="persName/forename" incremental="true">
                                <xf:label>Prénom</xf:label>
                            </xf:input>
                            <xf:input ref="occupation" incremental="true">
                                <xf:label>profession</xf:label>
                            </xf:input>
                            <xf:trigger>
                                <xf:label>Supprimer un entrepreneur, architecte ou maître d’œuvre</xf:label>
                                <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//description/participants/craftmen/craftman) > 1"/>
                            </xf:trigger>
                        </xf:repeat>
                        <xf:trigger>
                            <xf:label>Ajouter un entrepreneur, architecte ou maître d’œuvre</xf:label>
                            <xf:action ev:event="DOMActivate">
                                <xf:insert nodeset="craftman" at="index('repeatCraftman')" position="after" ev:event="DOMActivate"/>
                                <xf:setvalue ref="craftman[index('repeatCraftman')]/persName/surname" value=""/>
                                <xf:setvalue ref="craftman[index('repeatCraftman')]/persName/forename" value=""/>
                                <xf:setvalue ref="craftman[index('repeatCraftman')]/occupation" value=""/>
                            </xf:action>
                        </xf:trigger>
                    </xf:group>
                    <!--control-->
                    <pre>
                            <xf:output value="serialize(description/participants/craftmen, 'yes')"/>
                        </pre>
                </xf:case>
                <xf:case id="conclusionsPanel" selected="false">
                    <xf:label>Conclusions ou dispositifs de l’expertise</xf:label>
                    <xf:group ref="description/conclusions">
                        <xf:select1 bind="agreement" appearance="full">
                            <xf:item>
                                <xf:label>Accord</xf:label>
                                <xf:value>Accord</xf:value>
                                <xf:action ev:event="xforms-select">
                                    <xf:setvalue bind="agreementType">agreement</xf:setvalue>
                                </xf:action>
                            </xf:item>
                            <xf:item>
                                <xf:label>Désaccord</xf:label>
                                <xf:value>Désaccord</xf:value>
                                <xf:action ev:event="xforms-select">
                                    <xf:setvalue bind="agreementType">disagreement</xf:setvalue>
                                </xf:action>
                            </xf:item>
                            <xf:item>
                                <xf:label>Sans conclusion</xf:label>
                                <xf:value>Sans conclusion</xf:value>
                                <xf:action ev:event="xforms-select">
                                    <xf:setvalue bind="agreementType">noConclusion</xf:setvalue>
                                </xf:action>
                            </xf:item>
                        </xf:select1>
                        <xf:repeat id="repeatOpinion" bind="opinion">
                            <xf:label>Transcription de toutes les conclusions ou dispositifs d’experts</xf:label>
                            <xf:textarea ref="." incremental="true">
                                <xf:label>Conclusions</xf:label>
                            </xf:textarea>
                            <xf:trigger>
                                <xf:label>Supprimer une conclusion</xf:label>
                                <xf:delete nodeset="." at="1" ev:event="DOMActivate" if="count(//description/conclusions/opinion) > 1"/>
                            </xf:trigger>
                        </xf:repeat>
                        <xf:trigger>
                            <xf:label>Ajouter une conclusion</xf:label>
                            <xf:action ev:event="DOMActivate">
                                <xf:insert nodeset="opinion" at="index('repeatOpinion')" position="after" ev:event="DOMActivate"/>
                                <xf:setvalue ref="opinion[index('repeatOpinion')]" value=""/>
                            </xf:action>
                        </xf:trigger>
                        <xf:input bind="estimate">
                            <xf:label>Montant global (pour les estimations)</xf:label>
                        </xf:input>
                        <xf:group ref="fees">
                            <xf:label>Coût de l’expertise</xf:label>
                            <xf:select1 bind="feesDetail" appearance="full">
                                <xf:label>Détail</xf:label>
                                <xf:item>
                                    <xf:label>oui</xf:label>
                                    <xf:value>true</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>non</xf:label>
                                    <xf:value>false</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:delete ref="instance('xprModel')/description/conclusions/fees/fee[@type]"/>
                                    </xf:action>
                                </xf:item>
                            </xf:select1>
                            <xf:select ref="instance('xprFees')/fee" appearance="full">
                                <xf:item>
                                    <xf:label>Expert(s)</xf:label>
                                    <xf:value>expert</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/conclusions/fees" origin="instance('xprFees')/fee[@type='expert']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/conclusions/fees/fee[@type='expert']"/>
                                    </xf:action>
                                    <xf:group ref="instance('xprModel')/description/conclusions/fees/fee[@type='expert']">
                                        <xf:label>Montant</xf:label>
                                        <xf:input ref="@l"><xf:label>livres</xf:label></xf:input>
                                        <xf:input ref="@d"><xf:label>deniers</xf:label></xf:input>
                                        <xf:input ref="@s"><xf:label>sols</xf:label></xf:input>
                                    </xf:group>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Greffier</xf:label>
                                    <xf:value>clerk</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/conclusions/fees" origin="instance('xprFees')/fee[@type='clerk']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/conclusions/fees/fee[@type='clerk']"/>
                                    </xf:action>
                                    <xf:group ref="instance('xprModel')/description/conclusions/fees/fee[@type='clerk']">
                                        <xf:label>Montant</xf:label>
                                        <xf:input ref="@l"><xf:label>livres</xf:label></xf:input>
                                        <xf:input ref="@d"><xf:label>deniers</xf:label></xf:input>
                                        <xf:input ref="@s"><xf:label>sols</xf:label></xf:input>
                                    </xf:group>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Rôles</xf:label>
                                    <xf:value>rolls</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/conclusions/fees" origin="instance('xprFees')/fee[@type='rolls']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/conclusions/fees/fee[@type='rolls']"/>
                                    </xf:action>
                                    <xf:group ref="instance('xprModel')/description/conclusions/fees/fee[@type='rolls']">
                                        <xf:label>Montant</xf:label>
                                        <xf:input ref="@l"><xf:label>livres</xf:label></xf:input>
                                        <xf:input ref="@d"><xf:label>deniers</xf:label></xf:input>
                                        <xf:input ref="@s"><xf:label>sols</xf:label></xf:input>
                                    </xf:group>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Papier et contrôle</xf:label>
                                    <xf:value/>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/conclusions/fees" origin="instance('xprFees')/fee[@type='papers']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/conclusions/fees/fee[@type='papers']"/>
                                    </xf:action>
                                    <xf:group ref="instance('xprModel')/description/conclusions/fees/fee[@type='papers']">
                                        <xf:label>Montant</xf:label>
                                        <xf:input ref="@l"><xf:label>livres</xf:label></xf:input>
                                        <xf:input ref="@d"><xf:label>deniers</xf:label></xf:input>
                                        <xf:input ref="@s"><xf:label>sols</xf:label></xf:input>
                                    </xf:group>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Plans</xf:label>
                                    <xf:value>plans</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/conclusions/fees" origin="instance('xprFees')/fee[@type='plans']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/conclusions/fees/fee[@type='plans']"/>
                                    </xf:action>
                                    <xf:group ref="instance('xprModel')/description/conclusions/fees/fee[@type='plans']">
                                        <xf:label>Montant</xf:label>
                                        <xf:input ref="@l"><xf:label>livres</xf:label></xf:input>
                                        <xf:input ref="@d"><xf:label>deniers</xf:label></xf:input>
                                        <xf:input ref="@s"><xf:label>sols</xf:label></xf:input>
                                    </xf:group>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Procureurs</xf:label>
                                    <xf:value>prosecutors</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/conclusions/fees" origin="instance('xprFees')/fee[@type='prosecutors']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/conclusions/fees/fee[@type='prosecutors']"/>
                                    </xf:action>
                                    <xf:group ref="instance('xprModel')/description/conclusions/fees/fee[@type='prosecutors']">
                                        <xf:label>Montant</xf:label>
                                        <xf:input ref="@l"><xf:label>livres</xf:label></xf:input>
                                        <xf:input ref="@d"><xf:label>deniers</xf:label></xf:input>
                                        <xf:input ref="@s"><xf:label>sols</xf:label></xf:input>
                                    </xf:group>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Aides</xf:label>
                                    <xf:value>help</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/conclusions/fees" origin="instance('xprFees')/fee[@type='help']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/conclusions/fees/fee[@type='help']"/>
                                    </xf:action>
                                    <xf:group ref="instance('xprModel')/description/conclusions/fees/fee[@type='help']">
                                        <xf:label>Montant</xf:label>
                                        <xf:input ref="@l"><xf:label>livres</xf:label></xf:input>
                                        <xf:input ref="@d"><xf:label>deniers</xf:label></xf:input>
                                        <xf:input ref="@s"><xf:label>sols</xf:label></xf:input>
                                    </xf:group>
                                </xf:item>
                            </xf:select>
                        </xf:group>
                        <xf:group ref="expenses">
                            <xf:label>Bourse commune</xf:label>
                            <xf:select1 ref="@mentioned">
                                <xf:label>Mention(s) de la bourse commune (des experts ou greffiers) et détail</xf:label>
                                <xf:item>
                                    <xf:label>Oui</xf:label>
                                    <xf:value>true</xf:value>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Non</xf:label>
                                    <xf:value>false</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:delete ref="instance('xprModel')/description/conclusions/expenses/expense[@type]"/>
                                    </xf:action>
                                </xf:item>
                            </xf:select1>
                            <xf:select ref="instance('xprExpenses')/expense" appearance="full">
                                <xf:item>
                                    <xf:label>Bourse commune des experts</xf:label>
                                    <xf:value>expert</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/conclusions/expenses" origin="instance('xprExpenses')/expense[@type='expert']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/conclusions/expenses/expense[@type='expert']"/>
                                    </xf:action>
                                    <xf:group ref="instance('xprModel')/description/conclusions/expenses/expense[@type='expert']">
                                        <xf:label>Montant</xf:label>
                                        <xf:input ref="@l"><xf:label>livres</xf:label><xf:alert>requis</xf:alert></xf:input>
                                        <xf:input ref="@d"><xf:label>deniers</xf:label></xf:input>
                                        <xf:input ref="@s"><xf:label>sols</xf:label></xf:input>
                                    </xf:group>
                                </xf:item>
                                <xf:item>
                                    <xf:label>Bourse commune des greffiers</xf:label>
                                    <xf:value>clerk</xf:value>
                                    <xf:action ev:event="xforms-select">
                                        <xf:insert context="instance('xprModel')/description/conclusions/expenses" origin="instance('xprExpenses')/expense[@type='clerk']"/>
                                    </xf:action>
                                    <xf:action ev:event="xforms-deselect">
                                        <xf:delete ref="instance('xprModel')/description/conclusions/expenses/expense[@type='clerk']"/>
                                    </xf:action>
                                    <xf:group ref="instance('xprModel')/description/conclusions/expenses/expense[@type='clerk']">
                                        <xf:label>Montant</xf:label>
                                        <xf:input ref="@l"><xf:label>livres</xf:label></xf:input>
                                        <xf:input ref="@d"><xf:label>deniers</xf:label></xf:input>
                                        <xf:input ref="@s"><xf:label>sols</xf:label></xf:input>
                                    </xf:group>
                                </xf:item>
                            </xf:select>
                        </xf:group>
                    </xf:group>
                    <!--control-->
                    <pre>
                        <xf:output value="serialize(description/conclusions, 'yes')"/>
                    </pre>
                </xf:case>
                <xf:case id="" selected="false">
                    <xf:label/>
                    <xf:group ref=""> </xf:group>
                </xf:case>
            </xf:switch>
            <xf:submit submission="submit">
                <xf:label>Enregistrer</xf:label>
            </xf:submit>
        </form>
    </body>
</html>
